(()=>{"use strict";function t(t,n,e){const i=document.createElement(t);return i.className=n,e&&(i.innerText=e),i}class n{constructor(n,e){this.container=t("div","payment-icon"),this.container.dataset.name=e,this.container.classList.add(n)}html(){return this.container}}class e{constructor(){this.container=t("div","popup-message"),this.container.classList.add("hidden")}html(){return this.container}showWrong(t){this.container.innerText=t,this.container.classList.remove("hidden"),this.container.classList.add("wrong"),setTimeout((()=>{this.container.classList.add("hidden"),this.container.classList.remove("wrong"),this.container.innerText=""}),2e3)}showRight(t){this.container.innerText=t,this.container.classList.remove("hidden"),this.container.classList.add("right"),setTimeout((()=>{this.container.classList.add("hidden"),this.container.classList.remove("right"),this.container.innerText=""}),2e3)}hide(){this.container.classList.add("hidden"),this.container.classList.remove("right"),this.container.classList.remove("wrong"),this.container.innerText=""}}const i=[{name:"mir",codes:[[2200,2204]],logo:"mir-image"},{name:"master-card",codes:[[2221,2720],[51,55]],logo:"master-card-image"},{name:"visa",codes:[[4,4]],logo:"visa-image"},{name:"visa-electron",codes:[[4026,4026],[417500,417500],[4508,4508],[4844,4844],[4913,4913],[4917,4917]],logo:"visa-electron-image"},{name:"jcb",codes:[[3528,3589]],logo:"jcb-image"},{name:"china-union-pay",codes:[[62,62]],logo:"union-pay-image"}];class s{constructor(i){this.container=t("form","card-validator"),this.container.addEventListener("submit",(t=>{this.validate(t)})),this.icons=t("div","validator-icons"),i.forEach((t=>{const e=new n(t.logo,t.name);this.icons.appendChild(e.html())})),this.input=t("input","validator-input"),this.input.addEventListener("input",(()=>{this.valueChange()})),this.button=t("button","validator-button","Validate"),this.button.type="button",this.button.addEventListener("click",(t=>{this.validate(t)})),this.popupInfo=new e,this.container.appendChild(this.popupInfo.html()),this.container.append(this.icons,this.input,this.button)}html(){return this.container}validate(t){t.preventDefault();const n=this.input.value,e=function(t){const n=new RegExp("\\d{16}");if(!t.match(n))return{result:"error",message:"Entry is invalid: card ID must have 16 digits."};const e=parseInt(t[15],10),i=t.substring(0,15);let s=0;for(let t=13;t>0;t-=2)s+=parseInt(i[t],10);for(let t=14;t>=0;t-=2){const n=2*parseInt(i[t],10);s+=n>9?n%10+1:n}return(10-s%10)%10!==e?{result:"error",message:"Card ID is invalid."}:{result:"ok",message:"Card Id successfully verified."}}(n);if("error"===e.result)this.popupInfo.showWrong(e.message);else{this.popupInfo.showRight(e.message);const t=function(t){for(const n of i)for(const e of n.codes){const i=e[0].toString().length,s=t.substring(0,i);if(s>=e[0]&&s<=e[1])return{result:!0,name:n.name}}return{result:!1,name:"unknown"}}(n);t.result&&this.icons.querySelector(`[data-name=${t.name}]`).classList.remove("icon-hidden")}}valueChange(){Array.from(this.icons.children).forEach((t=>{t.classList.add("icon-hidden")}))}}window.onload=()=>{const t=new s(i);document.getElementById("container").append(t.html())}})();